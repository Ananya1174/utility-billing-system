

<div class="page-container">

  <h2>Billing Logs</h2>
  <p class="subtitle">All generated bills with status and details</p>
  <div class="filters">

    <select [(ngModel)]="status">
      <option value="">All Status</option>
      <option value="DUE">Due</option>
      <option value="PAID">Paid</option>
      <option value="OVERDUE">Overdue</option>
    </select>

    <select [(ngModel)]="month">
      <option [ngValue]="null">All Months</option>
      <option *ngFor="let m of months" [ngValue]="m">Month {{ m }}</option>
    </select>

    <select [(ngModel)]="year">
      <option [ngValue]="null">All Years</option>
      <option *ngFor="let y of years" [ngValue]="y">{{ y }}</option>
    </select>

    <input
      type="text"
      placeholder="Consumer ID"
      [(ngModel)]="consumerId" />

    <button class="primary-btn" (click)="loadBills()">Apply</button>
    <button class="ghost-btn" (click)="clearFilters()">Clear</button>

  </div>

  <div *ngIf="loading">Loading bills...</div>
  <div *ngIf="error" class="error">{{ error }}</div>

  <div class="card" *ngIf="!loading && pagedBills.length">

    <table>
      <thead>
        <tr>
          <th>Bill ID</th>
          <th>Consumer</th>
          <th>Utility</th>
          <th>Month</th>
          <th>Units</th>
          <th>Amount</th>
          <th>Status</th>
          <th>Due Date</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let b of pagedBills">
          <td class="mono">{{ b.id }}</td>
          <td class="mono">{{ b.consumerId }}</td>
          <td>{{ b.utilityType }}</td>
          <td>{{ b.billingMonth }}/{{ b.billingYear }}</td>
          <td>{{ b.consumptionUnits }}</td>
          <td>₹{{ b.totalAmount }}</td>
          <td>
            <span class="status" [class]="statusClass(b.status)">
              {{ b.status }}
            </span>
          </td>
          <td>{{ b.dueDate | date }}</td>
        </tr>
      </tbody>
    </table>

  </div>

  <div *ngIf="!loading && !pagedBills.length" class="empty">
    No billing records found
  </div>

  <div class="pagination" *ngIf="totalPages > 1">

    <div class="page-size">
      <label>Rows:</label>
      <select [(ngModel)]="pageSize" (change)="changePageSize()">
        <option *ngFor="let s of pageSizeOptions" [value]="s">
          {{ s }}
        </option>
      </select>
    </div>

    <div class="page-controls">

      <button (click)="prevPage()" [disabled]="pageIndex === 0">‹</button>

      <button
        *ngFor="let p of visiblePages()"
        (click)="goToPage(p)"
        [class.active]="p === pageIndex">
        {{ p + 1 }}
      </button>

      <button
        (click)="nextPage()"
        [disabled]="pageIndex === totalPages - 1">
        ›
      </button>
    </div>
  </div>
</div>