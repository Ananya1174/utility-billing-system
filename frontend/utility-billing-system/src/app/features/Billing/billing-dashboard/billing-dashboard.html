<h2>Billing Officer Dashboard</h2>

<div *ngIf="loading">Loading dashboard...</div>

<div *ngIf="!loading && summary">


  <div class="kpi-grid">
    <div class="kpi-card">
      <p>Total Bills</p>
      <h3>{{ summary.totalBills }}</h3>
    </div>

    <div class="kpi-card">
      <p>Total Amount Billed</p>
      <h3>â‚¹{{ outstandingSummary?.totalBilled }}</h3>
    </div>

    <div class="kpi-card warning">
      <p>Unpaid Bills</p>
      <h3>{{ unpaidCount }}</h3>
    </div>

    <div class="kpi-card danger">
      <p>Overdue Bills</p>
      <h3>{{ overdueCount }}</h3>
    </div>
  </div>


  <div class="filters below-kpi">
    <select [(ngModel)]="month" (change)="onDateChange()">
      <option *ngFor="let m of months" [value]="m">
        {{ monthNames[m - 1] }}
      </option>
    </select>

    <select [(ngModel)]="year" (change)="onDateChange()">
      <option *ngFor="let y of years" [value]="y">
        {{ y }}
      </option>
    </select>
  </div>


  <div class="card">
    <h3>
      Monthly Consumption ({{ selectedMonthName }} {{ year }})
    </h3>

    <canvas
      baseChart
      [data]="barChartData"
      [type]="barChartType">
    </canvas>
  </div>

  

  <div class="alerts">
    <div class="alert warning" *ngIf="unpaidCount > 0">
     {{ unpaidCount }} bills are pending payment
    </div>

    <div class="alert danger" *ngIf="overdueCount > 0">
      {{ overdueCount }} bills are overdue
    </div>
  </div>


<div class="actions">
  <button
    class="primary-btn"
    (click)="goToMeterReadings()">
    Add Meter Reading
  </button>

  <button
    class="primary-btn"
    (click)="goToGenerateBills()">
    Generate Bill
  </button>

  <button
    class="secondary-btn"
   (click)="goToViewBills()">
    View Billing Logs
  </button>
</div>

</div>