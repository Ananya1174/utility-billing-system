<h2>Billing Officer Dashboard</h2>

<div *ngIf="loading">Loading dashboard...</div>

<div *ngIf="!loading && summary">

  <!-- ================= DATE FILTER ================= -->

  <div class="filters">
    <select [(ngModel)]="month" (change)="onDateChange()">
      <option *ngFor="let m of months" [value]="m">
        Month {{ m }}
      </option>
    </select>

    <select [(ngModel)]="year" (change)="onDateChange()">
      <option *ngFor="let y of years" [value]="y">
        {{ y }}
      </option>
    </select>
  </div>

  <!-- ================= KPI CARDS ================= -->

  <div class="kpi-grid">
    <div class="kpi-card">
      <p>Total Bills</p>
      <h3>{{ summary.totalBills }}</h3>
    </div>

    <div class="kpi-card">
      <p>Total Amount Billed</p>
      <h3>‚Çπ{{ outstandingSummary?.totalBilled }}</h3>
    </div>

    <div class="kpi-card warning">
      <p>Unpaid Bills</p>
      <h3>{{ unpaidCount }}</h3>
    </div>

    <div class="kpi-card danger">
      <p>Overdue Bills</p>
      <h3>{{ overdueCount }}</h3>
    </div>
  </div>

  <!-- ================= CONSUMPTION CHART ================= -->

  <div class="card">
    <h3>Monthly Consumption ({{ month }}/{{ year }})</h3>

    <canvas
      baseChart
      [data]="barChartData"
      [type]="barChartType">
    </canvas>
  </div>

  <!-- ================= ALERTS ================= -->

  <div class="alerts">
    <div class="alert warning" *ngIf="unpaidCount > 0">
      ‚ö†Ô∏è {{ unpaidCount }} bills are pending payment
    </div>

    <div class="alert danger" *ngIf="overdueCount > 0">
      üî¥ {{ overdueCount }} bills are overdue
    </div>
  </div>

  <!-- ================= QUICK ACTIONS ================= -->

  <div class="actions">
    <button class="primary-btn" (click)="goToMeterReadings()">
      Add Meter Reading
    </button>

    <button class="primary-btn" (click)="goToGenerateBill()">
      Generate Bill
    </button>

    <button class="secondary-btn" (click)="goToBillingLogs()">
      View Billing Logs
    </button>
  </div>

</div>